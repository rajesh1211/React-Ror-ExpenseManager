var Tile=React.createClass({displayName:"Tile",render:function(){return React.createElement("li",{className:this.props.style},React.createElement("div",{className:"tile-inner"},React.createElement("h3",{className:"summary-tile-heading"},this.props.heading),React.createElement("div",{className:"summary-tile-body"},this.props.data)))}});
var Row=React.createClass({displayName:"Row",updateStatus:!1,getInitialState:function(){return{editRow:!1}},editExpense:function(){this.setState({editRow:!0})},deleteExpense:function(){var e=this;e.updateStatus||confirm.initConfirm("confirm","Are you sure , you want to delete this expense ?",function(){e.updateStatus=!0;var t=e.refs.deleteBtn.getDOMNode();t.classList.add("disabled"),e.props.deleteExpense(e.props.id,e.props.index,function(){t.classList.remove("disabled"),e.updateStatus=!1})},function(){return!1})},componentDidUpdate:function(){$("#date"+this.props.id).datepicker({dateFormat:"yy-mm-dd"})},cancelUpdate:function(){this.setState({editRow:!1})},updateExpense:function(){if(!self.updateStatus){self.updateStatus=!0;var e={};e.id=this.props.id,e.date=this.refs.date.getDOMNode().value,e.description=this.refs.description.getDOMNode().value,e.amount=this.refs.amount.getDOMNode().value;var t=this.refs.updateBtn.getDOMNode();t.classList.add("disabled"),this.validateForm(e,t)&&(this.props.updateExpense(e,this.props.index,function(){t.classList.remove("disabled"),self.updateStatus=!1}),this.setState({editRow:!1}),self.updateStatus=!1)}},validateForm:function(e,t){var a=this;return null==e.date||""==e.date?(confirm.initConfirm("alert","Date Field cannot be empty",function(){t.classList.remove("disabled"),a.updateStatus=!1}),!1):null==e.description||""==e.description?(confirm.initConfirm("alert","Description Field cannot be empty",function(){t.classList.remove("disabled"),a.updateStatus=!1}),!1):null==e.amount||""==e.amount?(confirm.initConfirm("alert","Amount Field cannot be empty",function(){t.classList.remove("disabled"),a.updateStatus=!1}),!1):null==e.amount&&""==e.amount||!e.amount.isNAN?!0:(confirm.initConfirm("alert","Please enter the valid amount",function(){t.classList.remove("disabled"),a.updateStatus=!1}),!1)},renderDisplay:function(){return React.createElement("div",{className:"tr"},React.createElement("span",{className:"td"},this.props.date),React.createElement("span",{className:"td"},this.props.description),React.createElement("span",{className:"td"},this.props.amount),React.createElement("span",{className:"td"},React.createElement("button",{ref:"editBtn",className:"btn btn-default",onClick:this.editExpense},"Edit"),React.createElement("button",{ref:"deleteBtn",className:"btn btn-danger",onClick:this.deleteExpense},React.createElement("span",{className:"active-txt"},"Delete"),React.createElement("span",{className:"disabled-txt"},"Deleting.."))))},renderForm:function(){return React.createElement("div",{className:"tr tr-form"},React.createElement("span",{className:"td"},React.createElement("input",{type:"text",id:"date"+this.props.id,className:"form-control",placeholder:"date",ref:"date",defaultValue:this.props.date})),React.createElement("span",{className:"td"},React.createElement("input",{type:"text",className:"form-control",placeholder:"Title",ref:"description",defaultValue:this.props.description})),React.createElement("span",{className:"td"},React.createElement("input",{type:"text",className:"form-control",placeholder:"Amount",ref:"amount",defaultValue:this.props.amount})),React.createElement("span",{className:"td"},React.createElement("button",{ref:"updateBtn",className:"btn btn-default",onClick:this.updateExpense},React.createElement("span",{className:"active-txt"},"Update"),React.createElement("span",{className:"disabled-txt"},"Updating..")),React.createElement("button",{className:"btn btn-danger",onClick:this.cancelUpdate},"Cancel")))},render:function(){return this.state.editRow?this.renderForm():this.renderDisplay()}});
var Table=React.createClass({displayName:"Table",createRow:function(e,a){return React.createElement(Row,{index:a,key:e.id,id:e.id,date:e.date,amount:e.amount,description:e.description,deleteExpense:this.props.deleteExpense,updateExpense:this.props.updateExpense},null)},render:function(){var e=!1;return this.props.data.length>0&&(e=!0),React.createElement("div",{className:"record-table-wrap"},React.createElement("div",{className:"record-table"},React.createElement("div",{className:"th"},React.createElement("span",{className:"heading-label"},"Date"),React.createElement("span",{className:"heading-label"},"Title"),React.createElement("span",{className:"heading-label"},"Amount"),React.createElement("span",{className:"heading-label"},"Actions")),React.createElement("div",{className:"table-body"},e?this.props.data.map(this.createRow):React.createElement("div",null,React.createElement("div",{className:"tr"},React.createElement("span",{className:"td"},"No Results Found"))))))}});
var Form=React.createClass({displayName:"Form",updateStatus:!1,addExpense:function(){var e=this;if(!e.updateStatus){e.updateStatus=!0;var t={};t.date=this.refs.date.getDOMNode().value,t.description=this.refs.description.getDOMNode().value,t.amount=this.refs.amount.getDOMNode().value;var a=this.refs.createBtn.getDOMNode();a.classList.add("disabled"),this.validateForm(t)?(this.props.addExpense(t,function(){a.classList.remove("disabled")}),this.resetForm(),e.updateStatus=!1):(a.classList.remove("disabled"),e.updateStatus=!1)}},componentDidMount:function(){$("#datepicker").datepicker({dateFormat:"yy-mm-dd"})},validateForm:function(e){return null==e.date||""==e.date?(confirm.initConfirm("alert","Date Field cannot be empty",function(){return!1}),!1):null==e.description||""==e.description?(confirm.initConfirm("alert","Description Field cannot be empty",function(){return!1}),!1):null==e.amount||""==e.amount?(confirm.initConfirm("alert","Amount Field cannot be empty",function(){return!1}),!1):null==e.amount&&""==e.amount||!e.amount.isNAN?!0:(confirm.initConfirm("alert","Please enter the valid amount",function(){return!1}),!1)},resetForm:function(){for(item in this.refs)this.refs[item].getDOMNode().value=null},render:function(){return React.createElement("div",{className:"add-record-form form-inline"},React.createElement("input",{ref:"date",id:"datepicker",type:"text",placeholder:"Date",className:"form-control"}),React.createElement("input",{ref:"description",type:"text",placeholder:"Title",className:"form-control"}),React.createElement("input",{ref:"amount",type:"number",placeholder:"Amount",className:"form-control"}),React.createElement("button",{ref:"createBtn",className:"btn btn-primary",onClick:this.addExpense},React.createElement("span",{className:"active-txt"},"Create record"),React.createElement("span",{className:"disabled-txt"},"Creating")))}});
var Summary=React.createClass({displayName:"Summary",render:function(){return React.createElement("div",{className:"summary-box"},React.createElement("div",{className:"summary"},React.createElement("h2",{className:"summary-heading"},"Records"),React.createElement("ul",{className:"summary-list"},React.createElement(Tile,{style:"summary-tile summary-tile--credit",heading:"Credit",data:this.props.data.credit}),React.createElement(Tile,{style:"summary-tile summary-tile--debit",heading:"Debit",data:this.props.data.debit}),React.createElement(Tile,{style:"summary-tile summary-tile--bal",heading:"Balance",data:this.props.data.balance}))))}});
var Expense=React.createClass({displayName:"Expense",getInitialState:function(){return{expenses:[],summary:{credit:0,debit:0,balance:0}}},componentWillMount:function(){var e=this;$.ajax({url:"/expenses",method:"GET",success:function(s){var t=e.updateSummary(s);e.setState({expenses:s,summary:t})},error:function(e){console.log(e),responseMessage.showError("Something went wrong")}})},updateSummary:function(e){var s={credit:0,debit:0,balance:0};for(item in e)parseFloat(e[item].amount)<0?s.credit+=-1*parseFloat(e[item].amount||0):s.debit+=parseFloat(e[item].amount||0);return s.debit=s.debit.toFixed(2),s.credit=s.credit.toFixed(2),s.balance=(s.debit-s.credit).toFixed(2),s},addExpense:function(e,s){var t=this,a={date:e.date,description:e.description,amount:e.amount};$.ajax({url:"/expenses",method:"POST",data:a,success:function(e){var a=t.state.expenses;a.unshift(e);var n=t.state.summary;n=t.updateSummary(a),t.setState({expenses:a,summary:n}),s(),responseMessage.showSuccess("Expense added successfully")},error:function(e){console.log(e),s(),responseMessage.showError("Something went wrong")}})},updateExpense:function(e,s,t){var a=this,n={id:e.id,date:e.date,description:e.description,amount:e.amount};$.ajax({url:"/expenses/"+n.id,method:"PATCH",data:n,success:function(e){var n=a.state.expenses;n[s]=e;var r=a.state.summary;r=a.updateSummary(n),a.setState({expenses:n,summary:r}),t(),responseMessage.showSuccess("Expense updated successfully")},error:function(e){console.log(e),t(),responseMessage.showError("Something went wrong")}})},deleteExpense:function(e,s,t){var a=this;$.ajax({url:"/expenses/"+e,method:"DELETE",success:function(e){var n=a.state.expenses;n.splice(s,1);var r=a.state.summary;r=a.updateSummary(n),a.setState({expenses:n,summary:r}),t(),responseMessage.showSuccess("Expense deleted successfully")},error:function(e){console.log(e),t(),responseMessage.showError("Something went wrong")}})},createForm:function(){return React.createElement(Form,{addExpense:this.addExpense},null)},createTable:function(){return React.createElement(Table,{data:this.state.expenses,deleteExpense:this.deleteExpense,updateExpense:this.updateExpense},null)},render:function(){return React.createElement("div",{className:"expense"},React.createElement(Summary,{data:this.state.summary}),this.createForm(),this.createTable())}});
React.render(React.createElement(Expense,null),document.getElementById("expense-container"));
var confirm=function(){var c=function(c){return document.getElementById(c)},n={type:"",msg:"",success:function(){},cancel:function(){},cachedDom:c("confirmBox")},s=function(){$(n.cachedDom).find(".confirm-msg").html(n.msg),n.cachedDom.classList.add("show"),"alert"==n.type&&n.cachedDom.classList.add("alert")},t=function(){n.cachedDom.classList.remove("show")};return this.initConfirm=function(c,t,i,o){n.type=c,n.msg=t,n.success=i,n.cancel=o,s()},this.submit=function(){n.success(),t()},this.closeConfirm=function(){t()},this.confirmCancel=function(){t(),n.cancel()},this}();
var responseMessage=function(){var s=function(s){return document.getElementById(s)},e=s("responseMessage");return this.showSuccess=function(s){e.classList.add("show","success"),e.innerHTML=s,setTimeout(function(){e.classList.remove("show","success")},1e3)},this.showError=function(s){e.classList.add("show","error"),e.innerHTML=s,setTimeout(function(){e.classList.remove("show","error")},1e3)},this}();